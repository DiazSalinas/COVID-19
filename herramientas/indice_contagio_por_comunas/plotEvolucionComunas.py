#!/usr/bin/env python2# -*- coding: utf-8 -*-"""Created on Tue Mar 31 11:55:42 2020@author: esteban"""# Este script necesita que instales # conda install geopandas#conda install -c conda-forge descartesimport geopandas as gpimport matplotlib.pyplot as pltimport pandas as pdimport numpy as npimport sys#reload(sys)#sys.setdefaultencoding('utf8')## Primero necesitamos cargar los polígonos de las comunas.# poligonos descargados desde https://www.bcn.cl/siit/mapas_vectoriales/index_html#shp_path = "../../fuentes/geometrias_comunas/comunas.shp"#comunasChile = gp.read_file(shp_path)#aprovechamos al toque de calcular la superficie de cada comuna en km2#comunasChile['superficie']=comunasChile.to_crs({'init': 'epsg:3035'}).area/10**6## Luego cargamos los datos del COVID19datos_path="../../Consolidado_COVID19_Chile_Comunas.CSV"#datos_path="../../COVID19_Chile_Comunas-casos_totales.CSV"datosComunas = pd.read_csv(datos_path)import numpy as npimport pandas as pdimport seaborn as snssns.set(style="whitegrid")rs = np.random.RandomState(365)values = rs.randn(365, 4).cumsum(axis=0)dates = pd.date_range("1 1 2016", periods=365, freq="D")data = pd.DataFrame(values, dates, columns=["A", "B", "C", "D"])data = data.rolling(7).mean()pivot=datosComunas[['fecha','nombre_comuna','casos_totales']].pivot(index='fecha', columns='nombre_comuna', values='casos_totales')datosComunas=datosComunas.set_index('fecha')sns.lineplot(data=pivot[['Las Condes','Maipú','Vitacura','Puente Alto','Santiago','Temuco']], palette="tab10", linewidth=2.5)